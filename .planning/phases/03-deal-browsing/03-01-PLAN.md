---
phase: 03-deal-browsing
plan: 01
type: execute
---

<objective>
Create the DealCard component with anonymous display following glassmorphic design system.

Purpose: Establish the core deal presentation that makes pricing visible while hiding business details until user verification.
Output: DealCard and DealCardSkeleton components in components/features/ layer.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@CLAUDE.md

**Depends on:** Phase 1 (design system, mock data), Phase 2 (location context)

**"Anonymous Until Committed" principle (from PROJECT.md):**
- Consumers see: treatment title, pricing, location area, rating, discount percent
- Hidden until verified account: business name, address, phone, specific location
- Visual indicator that business details are locked (blur/lock icon)

**Design direction:**
- Glassmorphic card styling (from 01-02-PLAN)
- Phosphor icons (Lock, Star, MapPin, Tag)
- Brand orange for discount badges and CTAs
- Medium-dark theme with glass borders

**Mock data types (from 01-03-PLAN):**
- AnonymousDeal: has locationArea, businessRating, businessReviewCount, businessTier
- TreatmentCategory: 'botox' | 'fillers' | 'facials' | 'laser' | 'body' | 'skincare'

**Component architecture:**
- DealCard goes in components/features/ (has domain logic for anonymous display)
- Uses Card, Badge from components/ui/
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DealCard component</name>
  <files>src/components/features/dealCard.tsx</files>
  <action>
Create src/components/features/dealCard.tsx with the anonymous deal display:

```tsx
'use client'

import { Star, MapPin, Lock, Tag } from '@phosphor-icons/react'
import { Card } from '@/components/ui/card'
import { Badge } from '@/components/ui/badge'
import type { AnonymousDeal, TreatmentCategory } from '@/types'

interface DealCardProps {
  deal: AnonymousDeal
  onClick?: () => void
  variant?: 'grid' | 'list'
}

const categoryLabels: Record<TreatmentCategory, string> = {
  botox: 'Botox',
  fillers: 'Fillers',
  facials: 'Facials',
  laser: 'Laser',
  body: 'Body',
  skincare: 'Skincare',
}

export function DealCard({ deal, onClick, variant = 'grid' }: DealCardProps) {
  // Implementation details:
  // 1. Card with hover state, glassmorphic styling
  // 2. Optional deal image at top (placeholder if none)
  // 3. Category badge (top-left)
  // 4. Discount badge (top-right) showing % off in brand orange
  // 5. Title and description
  // 6. Pricing section: original price struck through, deal price prominent
  // 7. Unit info (per unit, per session, etc.)
  // 8. Location area with MapPin icon
  // 9. Rating with Star icon and review count
  // 10. "Business Hidden" section with Lock icon and blur effect
  // 11. Featured/Sponsored indicators if applicable

  const isGrid = variant === 'grid'

  return (
    <Card
      hover
      padding="none"
      className={`overflow-hidden ${isGrid ? '' : 'flex'}`}
      onClick={onClick}
    >
      {/* Image Section */}
      <div className={`relative ${isGrid ? 'aspect-[4/3]' : 'w-48 shrink-0'} bg-bg-tertiary`}>
        {deal.imageUrl ? (
          <img
            src={deal.imageUrl}
            alt={deal.title}
            className="w-full h-full object-cover"
          />
        ) : (
          <div className="w-full h-full flex items-center justify-center">
            <Tag size={48} weight="light" className="text-text-muted" />
          </div>
        )}

        {/* Category Badge */}
        <Badge
          variant="default"
          size="sm"
          className="absolute top-3 left-3"
        >
          {categoryLabels[deal.category]}
        </Badge>

        {/* Discount Badge */}
        <Badge
          variant="brand"
          size="sm"
          className="absolute top-3 right-3"
        >
          {deal.discountPercent}% OFF
        </Badge>

        {/* Sponsored indicator */}
        {deal.isSponsored && (
          <span className="absolute bottom-3 left-3 text-xs text-text-muted bg-black/50 px-2 py-0.5 rounded">
            Sponsored
          </span>
        )}
      </div>

      {/* Content Section */}
      <div className="p-4 flex flex-col gap-3">
        {/* Title */}
        <h3 className="font-semibold text-text-primary line-clamp-2">
          {deal.title}
        </h3>

        {/* Description - only in list view */}
        {!isGrid && (
          <p className="text-sm text-text-secondary line-clamp-2">
            {deal.description}
          </p>
        )}

        {/* Pricing */}
        <div className="flex items-baseline gap-2">
          <span className="text-xl font-bold text-brand-primary">
            ${deal.dealPrice}
          </span>
          <span className="text-sm text-text-muted line-through">
            ${deal.originalPrice}
          </span>
          <span className="text-xs text-text-tertiary">
            {deal.unit}
          </span>
        </div>

        {/* Location & Rating */}
        <div className="flex items-center justify-between text-sm text-text-secondary">
          <div className="flex items-center gap-1">
            <MapPin size={14} weight="fill" className="text-text-tertiary" />
            <span>{deal.locationArea}</span>
          </div>
          <div className="flex items-center gap-1">
            <Star size={14} weight="fill" className="text-amber-400" />
            <span>{deal.businessRating.toFixed(1)}</span>
            <span className="text-text-muted">({deal.businessReviewCount})</span>
          </div>
        </div>

        {/* Business Hidden Indicator */}
        <div className="flex items-center gap-2 pt-2 border-t border-glass-border">
          <div className="flex items-center gap-1.5 text-text-tertiary">
            <Lock size={14} weight="fill" />
            <span className="text-xs">Business details hidden</span>
          </div>
          {deal.businessTier === 'paid' && (
            <Badge variant="brand" size="sm">Verified</Badge>
          )}
        </div>
      </div>
    </Card>
  )
}
```

Key implementation notes:
- Use 'use client' for onClick interactivity
- Support both grid and list variants via prop
- Show Lock icon with "Business details hidden" text
- Use brand-primary color for deal price and discount badge
- Show Verified badge for paid tier businesses
- Handle missing images with Tag icon placeholder
- line-clamp for text truncation
  </action>
  <verify>Component imports correctly, TypeScript compiles, renders with mock deal data</verify>
  <done>DealCard component displaying anonymous deal with pricing visible, business hidden, glassmorphic styling</done>
</task>

<task type="auto">
  <name>Task 2: Create DealCardSkeleton component</name>
  <files>src/components/features/dealCardSkeleton.tsx</files>
  <action>
Create src/components/features/dealCardSkeleton.tsx for loading states:

```tsx
import { Card } from '@/components/ui/card'

interface DealCardSkeletonProps {
  variant?: 'grid' | 'list'
}

export function DealCardSkeleton({ variant = 'grid' }: DealCardSkeletonProps) {
  const isGrid = variant === 'grid'

  return (
    <Card padding="none" className={`overflow-hidden ${isGrid ? '' : 'flex'}`}>
      {/* Image Skeleton */}
      <div
        className={`
          ${isGrid ? 'aspect-[4/3]' : 'w-48 shrink-0 h-full'}
          bg-bg-tertiary animate-pulse
        `}
      />

      {/* Content Skeleton */}
      <div className="p-4 flex flex-col gap-3 flex-1">
        {/* Title skeleton */}
        <div className="h-5 bg-bg-tertiary rounded animate-pulse w-3/4" />

        {/* Description skeleton - list only */}
        {!isGrid && (
          <div className="space-y-1.5">
            <div className="h-3 bg-bg-tertiary rounded animate-pulse" />
            <div className="h-3 bg-bg-tertiary rounded animate-pulse w-2/3" />
          </div>
        )}

        {/* Price skeleton */}
        <div className="flex items-center gap-2">
          <div className="h-6 w-16 bg-bg-tertiary rounded animate-pulse" />
          <div className="h-4 w-12 bg-bg-tertiary rounded animate-pulse" />
        </div>

        {/* Location & rating skeleton */}
        <div className="flex justify-between">
          <div className="h-4 w-24 bg-bg-tertiary rounded animate-pulse" />
          <div className="h-4 w-16 bg-bg-tertiary rounded animate-pulse" />
        </div>

        {/* Business hidden skeleton */}
        <div className="pt-2 border-t border-glass-border">
          <div className="h-4 w-32 bg-bg-tertiary rounded animate-pulse" />
        </div>
      </div>
    </Card>
  )
}
```

This provides a matching skeleton layout for loading states with:
- Same structure as DealCard
- Pulse animation on placeholder elements
- Support for grid/list variants
- Matches the glassmorphic card styling
  </action>
  <verify>Component renders, animation visible, matches DealCard dimensions</verify>
  <done>DealCardSkeleton matching DealCard layout with loading animation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] DealCard renders with all AnonymousDeal fields
- [ ] Grid and list variants display correctly
- [ ] Discount badge shows correct percentage
- [ ] Lock icon and "Business details hidden" text visible
- [ ] DealCardSkeleton matches DealCard dimensions
- [ ] `npm run build` succeeds
- [ ] `npm run lint` passes
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- DealCard supports grid and list variants
- Anonymous display hides business details appropriately
- Glassmorphic styling consistent with design system
- Skeleton provides smooth loading experience
</success_criteria>

<output>
After completion, create `.planning/phases/03-deal-browsing/03-01-SUMMARY.md`
</output>
